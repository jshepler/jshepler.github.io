<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NGU tools</title>
</head>
<body>
    <table>
        <tr>
            <th>Energy</th>
            <th>Power</th>
            <th>Cap</th>
            <th>Bars</th>
        </tr>
        <tr>
            <td>buy ALL for</td>
            <td colspan="3">
                <input data-bind="textInput: totalEnergyExpSpend"/>
            </td>
        </tr>
        <tr>
            <td>amount</td>
            <td data-bind="text: EPamount"></td>
            <td data-bind="text: ECamount"></td>
            <td data-bind="text: EBamount"></td>
        </tr>
        <tr>
            <td>buy for</td>
            <td data-bind="text: EPexp"></td>
            <td data-bind="text: ECexp"></td>
            <td data-bind="text: EBexp"></td>
        </tr>
        <tr><td colspan="4">&nbsp;</td></tr>

        <tr>
            <th>Magic</th>
            <th>Power</th>
            <th>Cap</th>
            <th>Bars</th>
        </tr>
        <tr>
            <td>buy ALL for</td>
            <td colspan="3">
                <input data-bind="textInput: totalMagicExpSpend"/>
            </td>
        </tr>
        <tr>
            <td>amount</td>
            <td data-bind="text: MPamount"></td>
            <td data-bind="text: MCamount"></td>
            <td data-bind="text: MBamount"></td>
        </tr>
        <tr>
            <td>buy for</td>
            <td data-bind="text: MPexp"></td>
            <td data-bind="text: MCexp"></td>
            <td data-bind="text: MBexp"></td>
        </tr>
        <tr><td colspan="4">&nbsp;</td></tr>

        <tr>
            <th>R3</th>
            <th>Power</th>
            <th>Cap</th>
            <th>Bars</th>
        </tr>
        <tr>
            <td>buy ALL for</td>
            <td colspan="3">
                <input data-bind="textInput: totalR3ExpSpend"/>
            </td>
        </tr>
        <tr>
            <td>amount</td>
            <td data-bind="text: R3Pamount"></td>
            <td data-bind="text: R3Camount"></td>
            <td data-bind="text: R3Bamount"></td>
        </tr>
        <tr>
            <td>buy for</td>
            <td data-bind="text: R3Pexp"></td>
            <td data-bind="text: R3Cexp"></td>
            <td data-bind="text: R3Bexp"></td>
        </tr>
    </table>

    <script type='text/javascript' src='knockout-3.5.1.js'></script>
    <script>
        (function() {
            let cost = {
                EP: 150,
                EC: (40 / 10000),
                EB: 80,
                MP: 450,
                MC: (120 / 10000),
                MB: 240,
                R3P: 15e+6,
                R3C: (4e+6 / 10000),
                R3B: 8e+6
            };
            
            let ratio = {P: 2, C: 75000, B: 5};
            let ratioCost = {
                EP: ratio.P * cost.EP,
                EC: ratio.C * cost.EC,
                EB: ratio.B * cost.EB,
                MP: ratio.P * cost.MP,
                MC: ratio.C * cost.MC,
                MB: ratio.B * cost.MB,
                R3P: ratio.P * cost.R3P,
                R3C: ratio.C * cost.R3C,
                R3B: ratio.B * cost.R3B
            };

            let ratioCostTotal = {
                E: ratioCost.EP + ratioCost.EC + ratioCost.EB,
                M: ratioCost.MP + ratioCost.MC + ratioCost.MB,
                R3: ratioCost.R3P + ratioCost.R3C + ratioCost.R3B
            };

            let expPct = {
                EP: ratioCost.EP / ratioCostTotal.E,
                EC: ratioCost.EC / ratioCostTotal.E,
                EB: ratioCost.EB / ratioCostTotal.E,
                MP: ratioCost.MP / ratioCostTotal.M,
                MC: ratioCost.MC / ratioCostTotal.M,
                MB: ratioCost.MB / ratioCostTotal.M,
                R3P: ratioCost.R3P / ratioCostTotal.R3,
                R3C: ratioCost.R3C / ratioCostTotal.R3,
                R3B: ratioCost.R3B / ratioCostTotal.R3
            };

            let vm = {
                totalEnergyExpSpend: ko.observable(1e+9),
                totalMagicExpSpend: ko.observable(1e+9),
                totalR3ExpSpend: ko.observable(1e+9)
            };

            vm.EPexp = ko.computed(() => (vm.totalEnergyExpSpend() * expPct.EP).toFixed(0));
            vm.EPamount = ko.computed(() => (vm.EPexp() / cost.EP).toFixed(0));

            vm.ECexp = ko.computed(() => (vm.totalEnergyExpSpend() * expPct.EC).toFixed(0));
            vm.ECamount = ko.computed(() => (vm.ECexp() / cost.EC).toFixed(0));

            vm.EBexp = ko.computed(() => (vm.totalEnergyExpSpend() * expPct.EB).toFixed(0));
            vm.EBamount = ko.computed(() => (vm.EBexp() / cost.EB).toFixed(0));

            vm.MPexp = ko.computed(() => (vm.totalMagicExpSpend() * expPct.MP).toFixed(0));
            vm.MPamount = ko.computed(() => (vm.MPexp() / cost.MP).toFixed(0));

            vm.MCexp = ko.computed(() => (vm.totalMagicExpSpend() * expPct.MC).toFixed(0));
            vm.MCamount = ko.computed(() => (vm.MCexp() / cost.MC).toFixed(0));

            vm.MBexp = ko.computed(() => (vm.totalMagicExpSpend() * expPct.MB).toFixed(0));
            vm.MBamount = ko.computed(() => (vm.MBexp() / cost.MB).toFixed(0));

            vm.R3Pexp = ko.computed(() => (vm.totalR3ExpSpend() * expPct.R3P).toFixed(0));
            vm.R3Pamount = ko.computed(() => (vm.R3Pexp() / cost.R3P).toFixed(0));

            vm.R3Cexp = ko.computed(() => (vm.totalR3ExpSpend() * expPct.R3C).toFixed(0));
            vm.R3Camount = ko.computed(() => (vm.R3Cexp() / cost.R3C).toFixed(0));

            vm.R3Bexp = ko.computed(() => (vm.totalR3ExpSpend() * expPct.R3B).toFixed(0));
            vm.R3Bamount = ko.computed(() => (vm.R3Bexp() / cost.R3B).toFixed(0));

            ko.applyBindings(vm);
        })();
    </script>
</body>
</html>